/*!
@file test_acceleration_mod_2.f90
@brief Validation tests for the `acceleration_mod` module.

@section Overview Overview

This test program performs a **quantitative validation** of the
`compute_acc` subroutine from the `acceleration_mod` module.

Unlike the first acceleration test, which checks only for qualitative
behavior (non-zero force), this test verifies that:

- The **magnitude** of the acceleration is correct.
- The **projection of the force onto the X, Y, and Z axes** is computed
  consistently.
- The symmetry of the force components in a fully three-dimensional
  configuration is preserved.

The test therefore provides a stricter validation of the force
implementation.

@note
Structured and partially generated by ChatGPT.
---

@section Physical_Setup Physical setup

A minimal two-particle system is considered:

- Number of atoms: 2
- Masses: unit mass for both atoms.
- Lennard-Jones parameters:  
  \f$\epsilon = 1\f$, \f$\sigma = 1\f$

The atomic positions are:

- Atom 1: \f$(0,0,0)\f$
- Atom 2: \f$(1,1,1)\f$

This places the atoms along the **main spatial diagonal**, ensuring that
the force vector has **equal projections on X, Y, and Z**.

The interatomic distance is therefore:

\f[
r = \sqrt{1^2 + 1^2 + 1^2} = \sqrt{3}
\f]

---

@section Theory Theory and reference formula

The Lennard-Jones force magnitude between two atoms is given by:

\f[
\vec{F}_{ij} =
24 \epsilon \frac{1}{r_{ij}^2}
\left[
2 \left(\frac{\sigma}{r_{ij}}\right)^{12}
-
\left(\frac{\sigma}{r_{ij}}\right)^6
\right]
\vec{r}_{ij}
\f]

Since the mass is unity, the acceleration is numerically equal to the
force:

\f[
\vec{a}_i = \vec{F}_{ij}
\f]

For the chosen geometry, the distance vector components are identical,
and therefore:

\f[
a_x = a_y = a_z
\f]

This symmetry provides a robust consistency check.

---

@section Manual_Calculation Manual reference calculation

The test computes the expected acceleration manually using:

- \f$r^2 = 3\f$
- \f$1/r^2\f$, \f$1/r^6\f$, and \f$1/r^{12}\f$
- The scalar force prefactor from the Lennard-Jones expression.

The expected acceleration component along each axis is obtained by
multiplying the scalar force by the corresponding component of the
distance vector and dividing by the mass.

This reference value is compared directly with the output of
`compute_acc`.

---

@section Verification Verification criteria

The calculated acceleration components are validated using the condition:

\f[
|a_{\text{computed}} - a_{\text{expected}}| < 10^{-8}
\f]

The tolerance accounts for floating-point round-off while remaining
strict enough to detect implementation errors.

The following conditions must be simultaneously satisfied:

- X component matches the reference value.
- Y component matches the reference value.
- Z component matches the reference value.

Failure of any component indicates an incorrect force projection or
normalization.

---

@section Expected_Output Expected output

On success, the program prints:

- The calculated and expected X acceleration.
- Confirmation messages indicating that X, Y, and Z components are correct.

Any deviation beyond the tolerance produces a failure message for the
corresponding component.

---

@section Design_Notes Design notes

- This is a **deterministic numerical test**, not a qualitative check.
- The diagonal geometry is deliberately chosen to expose:
  - Errors in vector normalization.
  - Incorrect handling of Cartesian components.
  - Missing symmetry in force accumulation.
- The test complements simpler unit tests and is suitable for regression
  testing.

---

@note
This test assumes no periodic boundary conditions and neglects cutoff
effects. It is intended purely for validation of the core Lennard-Jones
force implementation.
*/

